{"api_version":"3.0","metadata":{"creation_time":"1549573278292400","kind":"blueprint","last_update_time":"1549573815567021","name":"Splunk-Demo","spec_version":1},"spec":{"description":"","name":"Splunk-Demo","resources":{"app_profile_list":[{"action_list":[],"deployment_create_list":[{"action_list":[],"depends_on_list":[],"description":"","max_replicas":"2","min_replicas":"2","name":"0cef6335_deployment","package_local_reference_list":[{"kind":"app_package","name":"Package1"}],"published_service_local_reference_list":[],"substrate_local_reference":{"kind":"app_substrate","name":"SplunkINDX"},"type":"GREENFIELD","variable_list":[]},{"action_list":[],"depends_on_list":[],"description":"","max_replicas":"1","min_replicas":"1","name":"0cef6335_deployment_cloned_0","package_local_reference_list":[{"kind":"app_package","name":"Package_Master"}],"published_service_local_reference_list":[],"substrate_local_reference":{"kind":"app_substrate","name":"SplunkMaster"},"type":"GREENFIELD","variable_list":[]},{"action_list":[],"depends_on_list":[],"description":"","max_replicas":"1","min_replicas":"1","name":"0cef6335_deployment_cloned_0_cloned_0","package_local_reference_list":[{"kind":"app_package","name":"Package_SH"}],"published_service_local_reference_list":[],"substrate_local_reference":{"kind":"app_substrate","name":"SplunkSH"},"type":"GREENFIELD","variable_list":[]}],"description":"","name":"Splunk_App_Profile","variable_list":[{"attrs":{"type":""},"description":"","label":"","name":"INSTANCE_PUBLIC_KEY","type":"LOCAL","val_type":"STRING","value":"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCiK81m7NPZ47wd1yr3o\/gQQJiAJem5gnUVqgRiSPp8\/T\/Q+msDV490nZXlM1vLO2dT5wmtM6znghwDkr5qkxo51fNVtBsqplElQXHKJ2VHiXnF4FErYN8zaXsFLuObcWW6Fx+sOZHapXjEkpJbMdRBtNABh0yn6H5EJOw8DPHeUnwZfgPuCIUwZ7nxP+bSoDSaREYXuhN8lgQyzQH2BTHfwsntZtDtEvyR7\/10FUsHMCMLayeDM3eMLCkCqN4twMF8AUdc\/eZ6utjc5Iqdd98BFxlPj1CxhfWuRcTQNnZRJyfzqmNWnG8oJayGUg\/NnkHq1D2VAzd3uK\/5LDyOCQ2\/ centos@nutanix.com"},{"attrs":{"type":""},"description":"","editables":{"value":true},"label":"","name":"SERVER_NAME","type":"LOCAL","val_type":"STRING","value":""},{"attrs":{"is_secret_modified":false,"secret_reference":{},"type":""},"description":"","editables":{"value":true},"label":"","name":"SPLUNK_ADMIN_PASSWORD","type":"SECRET","val_type":"STRING","value":""},{"attrs":{"is_secret_modified":false,"secret_reference":{},"type":""},"description":"","editables":{"value":true},"label":"","name":"SPLUNK_LICENSE","type":"SECRET","val_type":"STRING","value":""}]}],"client_attrs":{"0cef6335_deployment":{"x":381,"y":64},"0cef6335_deployment_cloned_0":{"x":57,"y":56},"0cef6335_deployment_cloned_0_cloned_0":{"x":818,"y":61},"dc08849d-8d33-ea56-f565-850c43473e6a":{"x":371.25,"y":-174.5}},"credential_definition_list":[{"description":"","name":"Splunk_VM","secret":{"attrs":{"is_secret_modified":false,"secret_reference":{}}},"type":"KEY","username":"centos"}],"default_credential_local_reference":{"kind":"app_credential","name":"Splunk_VM"},"package_definition_list":[{"action_list":[],"description":"","name":"Package1","options":{"install_runbook":{"description":"","main_task_local_reference":{"kind":"app_task","name":"8b8e1190_dag"},"message_list":[],"name":"c1981290_runbook","state":"ACTIVE","task_definition_list":[{"attrs":{"edges":[{"edge_type":"user_defined","from_task_reference":{"kind":"app_task","name":"Setup_OS"},"to_task_reference":{"kind":"app_task","name":"Install_INDX"},"type":""}],"type":""},"child_tasks_local_reference_list":[{"kind":"app_task","name":"Install_INDX"},{"kind":"app_task","name":"Setup_OS"}],"description":"","message_list":[],"name":"8b8e1190_dag","retries":"0","state":"ACTIVE","target_any_local_reference":{"kind":"app_package","name":"Package1"},"timeout_secs":"0","type":"DAG","variable_list":[]},{"attrs":{"command_line_args":"","exit_status":[],"login_credential_local_reference":{"kind":"app_credential","name":"Splunk_VM"},"script":"#!\/bin\/bash\n\n# Install wget if it doesn't exist\nsudo yum -y install wget\n\n# Fetch Splunk binary\nwget -O splunk-7.1.2-a0c72a66db66-Linux-x86_64.tgz 'https:\/\/www.splunk.com\/bin\/splunk\/DownloadActivityServlet?architecture=x86_64&platform=linux&version=7.1.2&product=splunk&filename=splunk-7.1.2-a0c72a66db66-Linux-x86_64.tgz&wget=true'\n\n# User and Group\nsudo mkdir \/opt\/splunk\n# sudo groupadd splunk\n# sudo useradd -d \/opt\/splunk -m -g splunk splunk\n\n# Untar the binaries\ngunzip splunk-7.1.2-a0c72a66db66-Linux-x86_64.tgz\ntar -xvf splunk-7.1.2-a0c72a66db66-Linux-x86_64.tar\n\n# Set the admin password\nexport PASS=@@{SPLUNK_ADMIN_PASSWORD}@@\necho '[user_info]' > \/tmp\/user-seed.conf\necho 'USERNAME = admin' >> \/tmp\/user-seed.conf\necho 'PASSWORD = '$PASS >> \/tmp\/user-seed.conf\n\ncat \/tmp\/user-seed.conf\n\n# move Splunk setup to \/opt\nexport SPLUNK_HOME=\/opt\/splunk\nexport PATH=$SPLUNK_HOME\/bin:$PATH\nsudo cp -rp splunk\/* \/opt\/splunk\/\n\n# Change ownership of splunk folder\nsudo chown -R centos: \/opt\/splunk\/\n\n# Start splunk service\nsplunk start --answer-yes --no-prompt --accept-license\n\n# Stop splunk service\nsplunk stop\n\n# Copy the user credentials file\nsudo mv \/tmp\/user-seed.conf $SPLUNK_HOME\/etc\/system\/local\nsudo chown -R centos: $SPLUNK_HOME\/etc\/system\/local\/user-seed.conf\n\n# Copy data to server.conf for slave nodes\n# export MasterIP=@@{Splunk_Master.address}@@\n# MasterIP = MIP:8089\necho '[replication_port:\/\/9887]'  >> $SPLUNK_HOME\/etc\/system\/local\/server.conf\necho '[clustering]' >> $SPLUNK_HOME\/etc\/system\/local\/server.conf\necho 'master_uri = https:\/\/@@{Splunk_Master.address}@@:8089' >> $SPLUNK_HOME\/etc\/system\/local\/server.conf\necho 'mode = slave' >> $SPLUNK_HOME\/etc\/system\/local\/server.conf\necho 'pass4SymmKey = nutanix\/4u' >> $SPLUNK_HOME\/etc\/system\/local\/server.conf\n\n\n# Pause for 60 seconds to allow Master node to come online\npause 60\n\n# Start the splunk service again\nsplunk start\n","script_type":"sh","type":""},"child_tasks_local_reference_list":[],"description":"","message_list":[],"name":"Install_INDX","retries":"0","state":"ACTIVE","target_any_local_reference":{"kind":"app_service","name":"Splunk_INDX"},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"attrs":{"command_line_args":"","exit_status":[],"login_credential_local_reference":{"kind":"app_credential","name":"Splunk_VM"},"script":"#!\/bin\/bash\nset -ex\n\n# Disable THP\n# Check the current THP flags set\nsudo cat \/sys\/kernel\/mm\/transparent_hugepage\/enabled\nsudo cat \/sys\/kernel\/mm\/transparent_hugepage\/defrag\n\n# Disable THP\necho 'never' > sudo tee \/sys\/kernel\/mm\/transparent_hugepage\/enabled\necho 'never' > sudo tee \/sys\/kernel\/mm\/transparent_hugepage\/defrag\n\n# Check if the flags are set\nsudo cat \/sys\/kernel\/mm\/transparent_hugepage\/enabled\nsudo cat \/sys\/kernel\/mm\/transparent_hugepage\/defrag\n\n# Set the file descriptor limit\nsudo sysctl -w fs.file-max=65535\necho 'Current value of file descriptors set is ' \nsudo cat \/proc\/sys\/fs\/file-max\n\n# Set hostname\nsudo hostnamectl set-hostname @@{SERVER_NAME}@@-@@{calm_unique}@@\nsudo hostnamectl status\n","script_type":"sh","type":""},"child_tasks_local_reference_list":[],"description":"","message_list":[],"name":"Setup_OS","retries":"0","state":"ACTIVE","target_any_local_reference":{"kind":"app_service","name":"Splunk_INDX"},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"variable_list":[]},"type":"","uninstall_runbook":{"description":"","main_task_local_reference":{"kind":"app_task","name":"ef4a5c16_dag"},"message_list":[],"name":"74e6f4b4_runbook","state":"ACTIVE","task_definition_list":[{"attrs":{"edges":[],"type":""},"child_tasks_local_reference_list":[],"description":"","message_list":[],"name":"ef4a5c16_dag","retries":"0","state":"ACTIVE","target_any_local_reference":{"kind":"app_package","name":"Package1"},"timeout_secs":"0","type":"DAG","variable_list":[]}],"variable_list":[]}},"service_local_reference_list":[{"kind":"app_service","name":"Splunk_INDX"}],"type":"DEB","variable_list":[],"version":""},{"action_list":[],"description":"","name":"Package_Master","options":{"install_runbook":{"description":"","main_task_local_reference":{"kind":"app_task","name":"8b8e1190_dag_cloned_1"},"message_list":[],"name":"c1981290_runbook_cloned_0","state":"ACTIVE","task_definition_list":[{"attrs":{"edges":[{"edge_type":"user_defined","from_task_reference":{"kind":"app_task","name":"Setup_OS"},"to_task_reference":{"kind":"app_task","name":"Install_Master"},"type":""}],"type":""},"child_tasks_local_reference_list":[{"kind":"app_task","name":"Install_Master"},{"kind":"app_task","name":"Setup_OS"}],"description":"","message_list":[],"name":"8b8e1190_dag_cloned_1","retries":"0","state":"ACTIVE","target_any_local_reference":{"kind":"app_package","name":"Package_Master"},"timeout_secs":"0","type":"DAG","variable_list":[]},{"attrs":{"command_line_args":"","exit_status":[],"login_credential_local_reference":{"kind":"app_credential","name":"Splunk_VM"},"script":"#!\/bin\/bash\n\n# Install wget if it doesn't exist\nsudo yum -y install wget\n\n# Fetch Splunk binary\nwget -O splunk-7.1.2-a0c72a66db66-Linux-x86_64.tgz 'https:\/\/www.splunk.com\/bin\/splunk\/DownloadActivityServlet?architecture=x86_64&platform=linux&version=7.1.2&product=splunk&filename=splunk-7.1.2-a0c72a66db66-Linux-x86_64.tgz&wget=true'\n\n# User and Group\nsudo mkdir \/opt\/splunk\n# sudo groupadd splunk\n# sudo useradd -d \/opt\/splunk -m -g splunk splunk\n\n# Gather master IP for Indexers\n\n# Untar the binaries\ngunzip splunk-7.1.2-a0c72a66db66-Linux-x86_64.tgz\ntar -xvf splunk-7.1.2-a0c72a66db66-Linux-x86_64.tar\n\n# Set the admin password\nexport PASS=@@{SPLUNK_ADMIN_PASSWORD}@@\necho '[user_info]' > \/tmp\/user-seed.conf\necho 'USERNAME = admin' >> \/tmp\/user-seed.conf\necho 'PASSWORD = '$PASS >> \/tmp\/user-seed.conf\n\ncat \/tmp\/user-seed.conf\n\n# move Splunk setup to \/opt\nexport SPLUNK_HOME=\/opt\/splunk\nexport PATH=$SPLUNK_HOME\/bin:$PATH\nsudo cp -rp splunk\/* \/opt\/splunk\/\n\n# Change ownership of splunk folder\nsudo chown -R centos: \/opt\/splunk\/\n\n# Start splunk service\nsplunk start --answer-yes --no-prompt --accept-license\n\n# Stop splunk service\nsplunk stop\n\n# Copy the user credentials file\nsudo mv \/tmp\/user-seed.conf $SPLUNK_HOME\/etc\/system\/local\nsudo chown -R centos: $SPLUNK_HOME\/etc\/system\/local\/user-seed.conf\n\n# Set Master node config\necho '[clustering]' >> $SPLUNK_HOME\/etc\/system\/local\/server.conf\necho 'mode = master' >> $SPLUNK_HOME\/etc\/system\/local\/server.conf\necho 'replication_factor = 1' >> $SPLUNK_HOME\/etc\/system\/local\/server.conf\necho 'search_factor = 1' >> $SPLUNK_HOME\/etc\/system\/local\/server.conf\necho 'pass4SymmKey = nutanix\/4u' >> $SPLUNK_HOME\/etc\/system\/local\/server.conf\necho 'cluster_label = cluster1' >> $SPLUNK_HOME\/etc\/system\/local\/server.conf\n\n# Start the splunk service again\nsplunk start\n","script_type":"sh","type":""},"child_tasks_local_reference_list":[],"description":"","message_list":[],"name":"Install_Master","retries":"0","state":"ACTIVE","target_any_local_reference":{"kind":"app_service","name":"Splunk_Master"},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"attrs":{"command_line_args":"","exit_status":[],"login_credential_local_reference":{"kind":"app_credential","name":"Splunk_VM"},"script":"#!\/bin\/bash\nset -ex\n\n# Disable THP\n# Check the current THP flags set\nsudo cat \/sys\/kernel\/mm\/transparent_hugepage\/enabled\nsudo cat \/sys\/kernel\/mm\/transparent_hugepage\/defrag\n\n# Disable THP\necho 'never' > sudo tee \/sys\/kernel\/mm\/transparent_hugepage\/enabled\necho 'never' > sudo tee \/sys\/kernel\/mm\/transparent_hugepage\/defrag\n\n# Check if the flags are set\nsudo cat \/sys\/kernel\/mm\/transparent_hugepage\/enabled\nsudo cat \/sys\/kernel\/mm\/transparent_hugepage\/defrag\n\n# Set the file descriptor limit\nsudo sysctl -w fs.file-max=65535\necho 'Current value of file descriptors set is ' \nsudo cat \/proc\/sys\/fs\/file-max\n\n# Set hostname\nsudo hostnamectl set-hostname @@{SERVER_NAME}@@\nsudo hostnamectl status\n","script_type":"sh","type":""},"child_tasks_local_reference_list":[],"description":"","message_list":[],"name":"Setup_OS","retries":"0","state":"ACTIVE","target_any_local_reference":{"kind":"app_service","name":"Splunk_Master"},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"variable_list":[]},"type":"","uninstall_runbook":{"description":"","main_task_local_reference":{"kind":"app_task","name":"ef4a5c16_dag_cloned_1"},"message_list":[],"name":"74e6f4b4_runbook_cloned_0","state":"ACTIVE","task_definition_list":[{"attrs":{"edges":[],"type":""},"child_tasks_local_reference_list":[],"description":"","message_list":[],"name":"ef4a5c16_dag_cloned_1","retries":"0","state":"ACTIVE","target_any_local_reference":{"kind":"app_package","name":"Package_Master"},"timeout_secs":"0","type":"DAG","variable_list":[]}],"variable_list":[]}},"service_local_reference_list":[{"kind":"app_service","name":"Splunk_Master"}],"type":"DEB","variable_list":[],"version":""},{"action_list":[],"description":"","name":"Package_SH","options":{"install_runbook":{"description":"","main_task_local_reference":{"kind":"app_task","name":"8b8e1190_dag_cloned_1_cloned_1"},"message_list":[],"name":"c1981290_runbook_cloned_0_cloned_0","state":"ACTIVE","task_definition_list":[{"attrs":{"edges":[{"edge_type":"user_defined","from_task_reference":{"kind":"app_task","name":"Setup_OS"},"to_task_reference":{"kind":"app_task","name":"Install_SH"},"type":""}],"type":""},"child_tasks_local_reference_list":[{"kind":"app_task","name":"Install_SH"},{"kind":"app_task","name":"Setup_OS"}],"description":"","message_list":[],"name":"8b8e1190_dag_cloned_1_cloned_1","retries":"0","state":"ACTIVE","target_any_local_reference":{"kind":"app_package","name":"Package_SH"},"timeout_secs":"0","type":"DAG","variable_list":[]},{"attrs":{"command_line_args":"","exit_status":[],"login_credential_local_reference":{"kind":"app_credential","name":"Splunk_VM"},"script":"#!\/bin\/bash\n\n# Install wget if it doesn't exist\nsudo yum -y install wget\n\n# Fetch Splunk binary\nwget -O splunk-7.1.2-a0c72a66db66-Linux-x86_64.tgz 'https:\/\/www.splunk.com\/bin\/splunk\/DownloadActivityServlet?architecture=x86_64&platform=linux&version=7.1.2&product=splunk&filename=splunk-7.1.2-a0c72a66db66-Linux-x86_64.tgz&wget=true'\n\n# User and Group\nsudo mkdir \/opt\/splunk\n# sudo groupadd splunk\n# sudo useradd -d \/opt\/splunk -m -g splunk splunk\n\n# Untar the binaries\ngunzip splunk-7.1.2-a0c72a66db66-Linux-x86_64.tgz\ntar -xvf splunk-7.1.2-a0c72a66db66-Linux-x86_64.tar\n\n# Set the admin password\nexport PASS=@@{SPLUNK_ADMIN_PASSWORD}@@\necho '[user_info]' > \/tmp\/user-seed.conf\necho 'USERNAME = admin' >> \/tmp\/user-seed.conf\necho 'PASSWORD = '$PASS >> \/tmp\/user-seed.conf\n\ncat \/tmp\/user-seed.conf\n\n# move Splunk setup to \/opt\nexport SPLUNK_HOME=\/opt\/splunk\nexport PATH=$SPLUNK_HOME\/bin:$PATH\nsudo cp -rp splunk\/* \/opt\/splunk\/\n\n# Change ownership of splunk folder\nsudo chown -R centos: \/opt\/splunk\/\n\n# Start splunk service\nsplunk start --answer-yes --no-prompt --accept-license\n\n# Stop splunk service\nsplunk stop\n\n# Copy the user credentials file\nsudo mv \/tmp\/user-seed.conf $SPLUNK_HOME\/etc\/system\/local\nsudo chown -R centos: $SPLUNK_HOME\/etc\/system\/local\/user-seed.conf\n\n# Copy data to server.conf for slave nodes\n# export MasterIP=@@{Splunk_Master.address}@@\n#MasterIP=MIP:8089\necho '[clustering]' >> $SPLUNK_HOME\/etc\/system\/local\/server.conf\necho 'master_uri = https:\/\/@@{Splunk_Master.address}@@:8089' >> $SPLUNK_HOME\/etc\/system\/local\/server.conf\necho 'mode = searchhead' >> $SPLUNK_HOME\/etc\/system\/local\/server.conf\necho 'pass4SymmKey = nutanix\/4u' >> $SPLUNK_HOME\/etc\/system\/local\/server.conf\n\n# Pause for 60 seconds to allow Master node to come online\npause 60\n\n# Start the splunk service again\nsplunk start\n","script_type":"sh","type":""},"child_tasks_local_reference_list":[],"description":"","message_list":[],"name":"Install_SH","retries":"0","state":"ACTIVE","target_any_local_reference":{"kind":"app_service","name":"Splunk_SH"},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"attrs":{"command_line_args":"","exit_status":[],"login_credential_local_reference":{"kind":"app_credential","name":"Splunk_VM"},"script":"#!\/bin\/bash\nset -ex\n\n# Disable THP\n# Check the current THP flags set\nsudo cat \/sys\/kernel\/mm\/transparent_hugepage\/enabled\nsudo cat \/sys\/kernel\/mm\/transparent_hugepage\/defrag\n\n# Disable THP\necho 'never' > sudo tee \/sys\/kernel\/mm\/transparent_hugepage\/enabled\necho 'never' > sudo tee \/sys\/kernel\/mm\/transparent_hugepage\/defrag\n\n# Check if the flags are set\nsudo cat \/sys\/kernel\/mm\/transparent_hugepage\/enabled\nsudo cat \/sys\/kernel\/mm\/transparent_hugepage\/defrag\n\n# Set the file descriptor limit\nsudo sysctl -w fs.file-max=65535\necho 'Current value of file descriptors set is ' \nsudo cat \/proc\/sys\/fs\/file-max\n\n# Set hostname\nsudo hostnamectl set-hostname @@{SERVER_NAME}@@\nsudo hostnamectl status\n","script_type":"sh","type":""},"child_tasks_local_reference_list":[],"description":"","message_list":[],"name":"Setup_OS","retries":"0","state":"ACTIVE","target_any_local_reference":{"kind":"app_service","name":"Splunk_SH"},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"variable_list":[]},"type":"","uninstall_runbook":{"description":"","main_task_local_reference":{"kind":"app_task","name":"ef4a5c16_dag_cloned_1_cloned_1"},"message_list":[],"name":"74e6f4b4_runbook_cloned_0_cloned_0","state":"ACTIVE","task_definition_list":[{"attrs":{"edges":[],"type":""},"child_tasks_local_reference_list":[],"description":"","message_list":[],"name":"ef4a5c16_dag_cloned_1_cloned_1","retries":"0","state":"ACTIVE","target_any_local_reference":{"kind":"app_package","name":"Package_SH"},"timeout_secs":"0","type":"DAG","variable_list":[]}],"variable_list":[]}},"service_local_reference_list":[{"kind":"app_service","name":"Splunk_SH"}],"type":"DEB","variable_list":[],"version":""}],"published_service_definition_list":[],"service_definition_list":[{"action_list":[{"critical":false,"description":"System action for creating an application","name":"action_create","runbook":{"description":"","main_task_local_reference":{"kind":"app_task","name":"436b8806_dag"},"name":"6fa942e0_runbook","task_definition_list":[{"attrs":{"edges":[],"type":""},"child_tasks_local_reference_list":[],"description":"","name":"436b8806_dag","retries":"0","target_any_local_reference":{"kind":"app_service","name":"Splunk_INDX"},"timeout_secs":"0","type":"DAG","variable_list":[]}],"variable_list":[]},"type":"system"},{"critical":false,"description":"System action for deleting an application. Deletes created VMs as well","name":"action_delete","runbook":{"description":"","main_task_local_reference":{"kind":"app_task","name":"a33e37d9_dag"},"name":"ffa55735_runbook","task_definition_list":[{"attrs":{"edges":[],"type":""},"child_tasks_local_reference_list":[],"description":"","name":"a33e37d9_dag","retries":"0","target_any_local_reference":{"kind":"app_service","name":"Splunk_INDX"},"timeout_secs":"0","type":"DAG","variable_list":[]}],"variable_list":[]},"type":"system"},{"critical":false,"description":"System action for restarting an application","name":"action_restart","runbook":{"description":"","main_task_local_reference":{"kind":"app_task","name":"e3e43d46_dag"},"name":"42f57ffc_runbook","task_definition_list":[{"attrs":{"edges":[],"type":""},"child_tasks_local_reference_list":[],"description":"","name":"e3e43d46_dag","retries":"0","target_any_local_reference":{"kind":"app_service","name":"Splunk_INDX"},"timeout_secs":"0","type":"DAG","variable_list":[]}],"variable_list":[]},"type":"system"},{"critical":false,"description":"System action for starting an application","name":"action_start","runbook":{"description":"","main_task_local_reference":{"kind":"app_task","name":"c56edf45_dag"},"name":"7ab6e619_runbook","task_definition_list":[{"attrs":{"edges":[],"type":""},"child_tasks_local_reference_list":[],"description":"","name":"c56edf45_dag","retries":"0","target_any_local_reference":{"kind":"app_service","name":"Splunk_INDX"},"timeout_secs":"0","type":"DAG","variable_list":[]}],"variable_list":[]},"type":"system"},{"critical":false,"description":"System action for stopping an application","name":"action_stop","runbook":{"description":"","main_task_local_reference":{"kind":"app_task","name":"2cd45802_dag"},"name":"642b36dd_runbook","task_definition_list":[{"attrs":{"edges":[],"type":""},"child_tasks_local_reference_list":[],"description":"","name":"2cd45802_dag","retries":"0","target_any_local_reference":{"kind":"app_service","name":"Splunk_INDX"},"timeout_secs":"0","type":"DAG","variable_list":[]}],"variable_list":[]},"type":"system"}],"depends_on_list":[],"description":"","name":"Splunk_INDX","port_list":[],"singleton":false,"tier":"","variable_list":[]},{"action_list":[{"critical":false,"description":"System action for creating an application","name":"action_create","runbook":{"description":"","main_task_local_reference":{"kind":"app_task","name":"436b8806_dag_cloned_1"},"name":"6fa942e0_runbook_cloned_0","task_definition_list":[{"attrs":{"edges":[],"type":""},"child_tasks_local_reference_list":[],"description":"","name":"436b8806_dag_cloned_1","retries":"0","target_any_local_reference":{"kind":"app_service","name":"Splunk_Master"},"timeout_secs":"0","type":"DAG","variable_list":[]}],"variable_list":[]},"type":"system"},{"critical":false,"description":"System action for deleting an application. Deletes created VMs as well","name":"action_delete","runbook":{"description":"","main_task_local_reference":{"kind":"app_task","name":"a33e37d9_dag_cloned_1"},"name":"ffa55735_runbook_cloned_0","task_definition_list":[{"attrs":{"edges":[],"type":""},"child_tasks_local_reference_list":[],"description":"","name":"a33e37d9_dag_cloned_1","retries":"0","target_any_local_reference":{"kind":"app_service","name":"Splunk_Master"},"timeout_secs":"0","type":"DAG","variable_list":[]}],"variable_list":[]},"type":"system"},{"critical":false,"description":"System action for restarting an application","name":"action_restart","runbook":{"description":"","main_task_local_reference":{"kind":"app_task","name":"e3e43d46_dag_cloned_1"},"name":"42f57ffc_runbook_cloned_0","task_definition_list":[{"attrs":{"edges":[],"type":""},"child_tasks_local_reference_list":[],"description":"","name":"e3e43d46_dag_cloned_1","retries":"0","target_any_local_reference":{"kind":"app_service","name":"Splunk_Master"},"timeout_secs":"0","type":"DAG","variable_list":[]}],"variable_list":[]},"type":"system"},{"critical":false,"description":"System action for starting an application","name":"action_start","runbook":{"description":"","main_task_local_reference":{"kind":"app_task","name":"c56edf45_dag_cloned_1"},"name":"7ab6e619_runbook_cloned_0","task_definition_list":[{"attrs":{"edges":[],"type":""},"child_tasks_local_reference_list":[],"description":"","name":"c56edf45_dag_cloned_1","retries":"0","target_any_local_reference":{"kind":"app_service","name":"Splunk_Master"},"timeout_secs":"0","type":"DAG","variable_list":[]}],"variable_list":[]},"type":"system"},{"critical":false,"description":"System action for stopping an application","name":"action_stop","runbook":{"description":"","main_task_local_reference":{"kind":"app_task","name":"2cd45802_dag_cloned_1"},"name":"642b36dd_runbook_cloned_0","task_definition_list":[{"attrs":{"edges":[],"type":""},"child_tasks_local_reference_list":[],"description":"","name":"2cd45802_dag_cloned_1","retries":"0","target_any_local_reference":{"kind":"app_service","name":"Splunk_Master"},"timeout_secs":"0","type":"DAG","variable_list":[]}],"variable_list":[]},"type":"system"}],"depends_on_list":[],"description":"","name":"Splunk_Master","port_list":[],"singleton":false,"tier":"","variable_list":[]},{"action_list":[{"critical":false,"description":"System action for creating an application","name":"action_create","runbook":{"description":"","main_task_local_reference":{"kind":"app_task","name":"436b8806_dag_cloned_1_cloned_1"},"name":"6fa942e0_runbook_cloned_0_cloned_0","task_definition_list":[{"attrs":{"edges":[],"type":""},"child_tasks_local_reference_list":[],"description":"","name":"436b8806_dag_cloned_1_cloned_1","retries":"0","target_any_local_reference":{"kind":"app_service","name":"Splunk_SH"},"timeout_secs":"0","type":"DAG","variable_list":[]}],"variable_list":[]},"type":"system"},{"critical":false,"description":"System action for deleting an application. Deletes created VMs as well","name":"action_delete","runbook":{"description":"","main_task_local_reference":{"kind":"app_task","name":"a33e37d9_dag_cloned_1_cloned_1"},"name":"ffa55735_runbook_cloned_0_cloned_0","task_definition_list":[{"attrs":{"edges":[],"type":""},"child_tasks_local_reference_list":[],"description":"","name":"a33e37d9_dag_cloned_1_cloned_1","retries":"0","target_any_local_reference":{"kind":"app_service","name":"Splunk_SH"},"timeout_secs":"0","type":"DAG","variable_list":[]}],"variable_list":[]},"type":"system"},{"critical":false,"description":"System action for restarting an application","name":"action_restart","runbook":{"description":"","main_task_local_reference":{"kind":"app_task","name":"e3e43d46_dag_cloned_1_cloned_1"},"name":"42f57ffc_runbook_cloned_0_cloned_0","task_definition_list":[{"attrs":{"edges":[],"type":""},"child_tasks_local_reference_list":[],"description":"","name":"e3e43d46_dag_cloned_1_cloned_1","retries":"0","target_any_local_reference":{"kind":"app_service","name":"Splunk_SH"},"timeout_secs":"0","type":"DAG","variable_list":[]}],"variable_list":[]},"type":"system"},{"critical":false,"description":"System action for starting an application","name":"action_start","runbook":{"description":"","main_task_local_reference":{"kind":"app_task","name":"c56edf45_dag_cloned_1_cloned_1"},"name":"7ab6e619_runbook_cloned_0_cloned_0","task_definition_list":[{"attrs":{"edges":[],"type":""},"child_tasks_local_reference_list":[],"description":"","name":"c56edf45_dag_cloned_1_cloned_1","retries":"0","target_any_local_reference":{"kind":"app_service","name":"Splunk_SH"},"timeout_secs":"0","type":"DAG","variable_list":[]}],"variable_list":[]},"type":"system"},{"critical":false,"description":"System action for stopping an application","name":"action_stop","runbook":{"description":"","main_task_local_reference":{"kind":"app_task","name":"2cd45802_dag_cloned_1_cloned_1"},"name":"642b36dd_runbook_cloned_0_cloned_0","task_definition_list":[{"attrs":{"edges":[],"type":""},"child_tasks_local_reference_list":[],"description":"","name":"2cd45802_dag_cloned_1_cloned_1","retries":"0","target_any_local_reference":{"kind":"app_service","name":"Splunk_SH"},"timeout_secs":"0","type":"DAG","variable_list":[]}],"variable_list":[]},"type":"system"}],"depends_on_list":[],"description":"","name":"Splunk_SH","port_list":[],"singleton":false,"tier":"","variable_list":[]}],"substrate_definition_list":[{"action_list":[],"create_spec":{"availability_zone_reference":null,"backup_policy":null,"categories":"","cluster_reference":null,"name":"@@{SERVER_NAME}@@-INDX-@@{calm_time}@@","resources":{"boot_config":{"boot_device":{"disk_address":{"adapter_type":"SCSI","device_index":0,"type":""},"type":""},"mac_address":"","type":""},"disk_list":[{"data_source_reference":null,"device_properties":{"device_type":"DISK","disk_address":{"adapter_type":"SCSI","device_index":1,"type":""},"type":""},"disk_size_mib":768000,"type":"","volume_group_reference":null},{"data_source_reference":{"kind":"image","name":"CentOS-7.4","type":"","uuid":"bfb052a9-ae5f-434d-95a3-a218062aabc8"},"device_properties":{"device_type":"DISK","disk_address":{"adapter_type":"SCSI","device_index":0,"type":""},"type":""},"disk_size_mib":0,"type":"","volume_group_reference":null}],"gpu_list":[],"guest_customization":{"cloud_init":{"meta_data":"","type":"","user_data":"#cloud-config\nusers:\n  - name: centos\n    ssh-authorized-keys:\n      - @@{INSTANCE_PUBLIC_KEY}@@\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']"},"sysprep":null,"type":""},"guest_tools":null,"hardware_clock_timezone":"","memory_size_mib":12288,"nic_list":[{"ip_endpoint_list":[],"mac_address":"","network_function_chain_reference":null,"network_function_nic_type":"INGRESS","nic_type":"NORMAL_NIC","subnet_reference":{"kind":"subnet","name":"","type":"","uuid":"c08cd7a4-abbb-4008-8a49-8e51288d1a0f"},"type":""}],"num_sockets":12,"num_vcpus_per_socket":1,"parent_reference":null,"power_state":"ON","serial_port_list":[],"type":""},"type":""},"description":"","editables":{"create_spec":{"name":true,"resources":{"disk_list":{},"memory_size_mib":true,"nic_list":{},"num_sockets":true,"num_vcpus_per_socket":true,"serial_port_list":{}}}},"name":"SplunkINDX","os_type":"Linux","readiness_probe":{"address":"@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@","connection_port":22,"connection_type":"SSH","delay_secs":"0","disable_readiness_probe":false,"login_credential_local_reference":{"kind":"app_credential","name":"Splunk_VM"}},"type":"AHV_VM","variable_list":[]},{"action_list":[],"create_spec":{"availability_zone_reference":null,"backup_policy":null,"categories":"","cluster_reference":null,"name":"@@{SERVER_NAME}@@-Master-@@{calm_time}@@","resources":{"boot_config":{"boot_device":{"disk_address":{"adapter_type":"SCSI","device_index":0,"type":""},"type":""},"mac_address":"","type":""},"disk_list":[{"data_source_reference":null,"device_properties":{"device_type":"DISK","disk_address":{"adapter_type":"SCSI","device_index":1,"type":""},"type":""},"disk_size_mib":307200,"type":"","volume_group_reference":null},{"data_source_reference":{"kind":"image","name":"CentOS-7.4","type":"","uuid":"bfb052a9-ae5f-434d-95a3-a218062aabc8"},"device_properties":{"device_type":"DISK","disk_address":{"adapter_type":"SCSI","device_index":0,"type":""},"type":""},"disk_size_mib":0,"type":"","volume_group_reference":null}],"gpu_list":[],"guest_customization":{"cloud_init":{"meta_data":"","type":"","user_data":"#cloud-config\nusers:\n  - name: centos\n    ssh-authorized-keys:\n      - @@{INSTANCE_PUBLIC_KEY}@@\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']"},"sysprep":null,"type":""},"guest_tools":null,"hardware_clock_timezone":"","memory_size_mib":6144,"nic_list":[{"ip_endpoint_list":[],"mac_address":"","network_function_chain_reference":null,"network_function_nic_type":"INGRESS","nic_type":"NORMAL_NIC","subnet_reference":{"kind":"subnet","name":"","type":"","uuid":"c08cd7a4-abbb-4008-8a49-8e51288d1a0f"},"type":""}],"num_sockets":6,"num_vcpus_per_socket":1,"parent_reference":null,"power_state":"ON","serial_port_list":[],"type":""},"type":""},"description":"","editables":{"create_spec":{"name":true,"resources":{"disk_list":{},"memory_size_mib":true,"nic_list":{},"num_sockets":true,"num_vcpus_per_socket":true,"serial_port_list":{}}}},"name":"SplunkMaster","os_type":"Linux","readiness_probe":{"address":"@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@","connection_port":22,"connection_type":"SSH","delay_secs":"0","disable_readiness_probe":false,"login_credential_local_reference":{"kind":"app_credential","name":"Splunk_VM"}},"type":"AHV_VM","variable_list":[]},{"action_list":[],"create_spec":{"availability_zone_reference":null,"backup_policy":null,"categories":"","cluster_reference":null,"name":"@@{SERVER_NAME}@@-SH-@@{calm_time}@@","resources":{"boot_config":{"boot_device":{"disk_address":{"adapter_type":"SCSI","device_index":0,"type":""},"type":""},"mac_address":"","type":""},"disk_list":[{"data_source_reference":null,"device_properties":{"device_type":"DISK","disk_address":{"adapter_type":"SCSI","device_index":1,"type":""},"type":""},"disk_size_mib":307200,"type":"","volume_group_reference":null},{"data_source_reference":{"kind":"image","name":"CentOS-7.4","type":"","uuid":"bfb052a9-ae5f-434d-95a3-a218062aabc8"},"device_properties":{"device_type":"DISK","disk_address":{"adapter_type":"SCSI","device_index":0,"type":""},"type":""},"disk_size_mib":0,"type":"","volume_group_reference":null}],"gpu_list":[],"guest_customization":{"cloud_init":{"meta_data":"","type":"","user_data":"#cloud-config\nusers:\n  - name: centos\n    ssh-authorized-keys:\n      - @@{INSTANCE_PUBLIC_KEY}@@\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']"},"sysprep":null,"type":""},"guest_tools":null,"hardware_clock_timezone":"","memory_size_mib":6144,"nic_list":[{"ip_endpoint_list":[],"mac_address":"","network_function_chain_reference":null,"network_function_nic_type":"INGRESS","nic_type":"NORMAL_NIC","subnet_reference":{"kind":"subnet","name":"","type":"","uuid":"c08cd7a4-abbb-4008-8a49-8e51288d1a0f"},"type":""}],"num_sockets":6,"num_vcpus_per_socket":1,"parent_reference":null,"power_state":"ON","serial_port_list":[],"type":""},"type":""},"description":"","editables":{"create_spec":{"name":true,"resources":{"disk_list":{},"memory_size_mib":true,"nic_list":{},"num_sockets":true,"num_vcpus_per_socket":true,"serial_port_list":{}}}},"name":"SplunkSH","os_type":"Linux","readiness_probe":{"address":"@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@","connection_port":22,"connection_type":"SSH","delay_secs":"0","disable_readiness_probe":false,"login_credential_local_reference":{"kind":"app_credential","name":"Splunk_VM"}},"type":"AHV_VM","variable_list":[]}],"type":"USER"}},"status":{}}